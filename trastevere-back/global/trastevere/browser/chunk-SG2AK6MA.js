import{a as q,b as z,c as G,d as J}from"./chunk-3FSU4CAU.js";import{a as O,b as Q,c as W,d as X}from"./chunk-2K4EHN3J.js";import{b as K}from"./chunk-MCCIIHVS.js";import"./chunk-NOAOFUJL.js";import{a as $}from"./chunk-TFE47IIC.js";import"./chunk-KERRPVFC.js";import"./chunk-EPRKLT6B.js";import{a as H}from"./chunk-QVPVB6VW.js";import"./chunk-T6CLRISC.js";import"./chunk-GK6A4HIM.js";import"./chunk-5W2MNWRR.js";import"./chunk-4CJP5RBE.js";import"./chunk-732UR5WD.js";import{m as U}from"./chunk-FRF4WPMZ.js";import{e as k,f as V}from"./chunk-3YROUDBC.js";import"./chunk-TMHMHBU4.js";import"./chunk-3U2UQCJ5.js";import"./chunk-Q52T5SQV.js";import{v as u,y as B}from"./chunk-DPUVSD4U.js";import{m as A,p as F,q as P,r as j}from"./chunk-MVQCMINQ.js";import{$b as v,Gb as s,Hb as c,Ib as L,Nb as E,Ob as T,Pb as h,Qa as r,Qb as M,Ra as y,Rb as D,Sb as w,Z as g,ba as S,bb as p,bc as _,eb as l,jb as x,ka as C,la as b,mc as N,nb as i,ob as a,pb as d,tb as I,wb as R,xb as m}from"./chunk-YTQLSVMJ.js";var ee=()=>({"min-width":"50rem"});function te(t,n){t&1&&(i(0,"div",4),d(1,"p-progressSpinner",5),a())}function ie(t,n){t&1&&(i(0,"p"),s(1,"No hay reservas disponibles."),a())}function ne(t,n){t&1&&(i(0,"th"),s(1,"Usuario"),a())}function ae(t,n){if(t&1&&(i(0,"tr"),p(1,ne,2,0,"th"),i(2,"th"),s(3,"Fecha Inicio"),a(),i(4,"th"),s(5,"Fecha Final"),a(),i(6,"th"),s(7,"Huespedes"),a(),i(8,"th"),s(9,"Precio"),a(),i(10,"th"),s(11,"Baja"),a(),i(12,"th"),s(13,"Accion"),a()()),t&2){m(2);let e=h(0);r(),x(e?1:-1)}}function re(t,n){if(t&1&&(i(0,"td",9)(1,"p",14),s(2),a(),i(3,"p",14),s(4),a()()),t&2){let e=m().$implicit;r(2),c(e.usuario.name),r(2),c(e.usuario.email)}}function se(t,n){t&1&&d(0,"p-tag",15)}function oe(t,n){t&1&&d(0,"p-tag",16)}function le(t,n){t&1&&d(0,"p-tag",17)}function pe(t,n){if(t&1){let e=I();i(0,"p-button",18),R("onClick",function(){C(e);let f=m().$implicit,Z=m(2);return b(Z.deleteReserva(f))}),a()}}function me(t,n){if(t&1&&(i(0,"tr"),p(1,re,5,2,"td",9),i(2,"td"),s(3),v(4,"date"),a(),i(5,"td"),s(6),v(7,"date"),a(),i(8,"td"),s(9),a(),i(10,"td"),s(11),v(12,"currency"),a(),i(13,"td"),p(14,se,1,0,"p-tag",10)(15,oe,1,0,"p-tag",11)(16,le,1,0,"p-tag",12),a(),i(17,"td"),d(18,"p-toast"),p(19,pe,1,0,"p-button",13),a()()),t&2){let e=n.$implicit,o=m(2),f=h(0);r(),x(f?1:-1),r(2),c(_(4,9,e.fechaInicio,"yyyy-MM-dd")),r(3),c(_(7,12,e.fechaSalida,"yyyy-MM-dd")),r(3),L(" ",e.numHuespedes," "),r(2),c(_(12,15,e.precioFinal,"EUR")),r(3),l("ngIf",!e.deleted&&!o.reservaDateUntilNow(e)),r(),l("ngIf",!e.deleted&&o.reservaDateUntilNow(e)),r(),l("ngIf",e.deleted),r(3),l("ngIf",!e.deleted&&!o.reservaDateUntilNow(e))}}function de(t,n){if(t&1&&(i(0,"p-table",6),p(1,ae,14,1,"ng-template",7)(2,me,20,18,"ng-template",8),a()),t&2){let e=m();l("value",e.reservas)("tableStyle",w(2,ee))}}var Y=class t{constructor(n,e){this.cd=n;this.messageService=e}reservaService=g($);authService=g(H);reservas=[];isLoading=!0;ngOnInit(){let n={next:e=>{this.reservas=e,this.isLoading=!1,this.cd.detectChanges()},error:e=>{this.isLoading=!1,this.cd.detectChanges()}};this.authService.isAdmin?this.reservaService.allReservas().subscribe(n):this.reservaService.reservasByUser().subscribe(n)}deleteReserva(n){this.reservaService.deleteReserva(n).subscribe({next:e=>{n.deleted=!0,this.show(),this.cd.detectChanges()},error:()=>{this.showNotDeleted()},complete:()=>{}})}reservaDateUntilNow(n){let e=new Date;return new Date(n.fechaInicio)<=e}show(){this.messageService.add({severity:"success",summary:"Success",detail:"Reserva cancelada"})}showNotDeleted(){this.messageService.add({severity:"error",summary:"Error",detail:"Quedan menos de tres dias para la reserva."})}static \u0275fac=function(e){return new(e||t)(y(N),y(u))};static \u0275cmp=S({type:t,selectors:[["app-list-reservas"]],standalone:!0,features:[M([u]),D],decls:7,vars:4,consts:[[1,"flex","justify-content-start"],["class","card flex justify-content-center",4,"ngIf"],[4,"ngIf"],["dataKey","id","editMode","row",3,"value","tableStyle",4,"ngIf"],[1,"card","flex","justify-content-center"],["ariaLabel","loading"],["dataKey","id","editMode","row",3,"value","tableStyle"],["pTemplate","header"],["pTemplate","body"],[1,"flex","justify-content-center","flex-column"],["severity","success","value","Activa",4,"ngIf"],["severity","secondary","value","Procesada",4,"ngIf"],["severity","danger","value","Cancelada",4,"ngIf"],["icon","pi pi-times","severity","danger","rounded","","outlined","true",3,"onClick",4,"ngIf"],[1,"p-0","m-0"],["severity","success","value","Activa"],["severity","secondary","value","Procesada"],["severity","danger","value","Cancelada"],["icon","pi pi-times","severity","danger","rounded","","outlined","true",3,"onClick"]],template:function(e,o){e&1&&(E(0),i(1,"div",0)(2,"h2"),s(3,"Reservas"),a()(),p(4,te,2,0,"div",1)(5,ie,2,0,"p",2)(6,de,3,3,"p-table",3)),e&2&&(T(o.authService.isAdmin),r(4),l("ngIf",o.isLoading),r(),l("ngIf",!o.isLoading&&o.reservas.length===0),r(),l("ngIf",o.reservas.length>0))},dependencies:[Q,O,B,j,A,P,F,z,q,V,k,U,K,J,G,X,W],changeDetection:0})};export{Y as ListReservasComponent};
