import{a as J}from"./chunk-QBKHHZUT.js";import{a as q,b as G}from"./chunk-MCCIIHVS.js";import{a as $}from"./chunk-TFE47IIC.js";import{b as z,c as U}from"./chunk-KERRPVFC.js";import"./chunk-EPRKLT6B.js";import"./chunk-T6CLRISC.js";import"./chunk-4CJP5RBE.js";import{d as P}from"./chunk-33GP4NFC.js";import"./chunk-732UR5WD.js";import{e as j,g as O,m as k}from"./chunk-FRF4WPMZ.js";import{e as L}from"./chunk-3YROUDBC.js";import"./chunk-TMHMHBU4.js";import"./chunk-3U2UQCJ5.js";import"./chunk-Q52T5SQV.js";import{y as W}from"./chunk-DPUVSD4U.js";import{l as I,n as A,p as B,q as F,r as H}from"./chunk-MVQCMINQ.js";import{$b as x,Gb as s,Ib as h,Jb as b,Kb as y,Lb as S,Mb as T,Qa as r,Rb as w,Tb as M,Z as f,ac as N,ba as D,bb as u,bc as E,eb as C,jb as v,ka as c,la as p,mc as V,nb as n,ob as a,pb as d,tb as R,wb as g,xb as l}from"./chunk-YTQLSVMJ.js";var Q=t=>({textDecoration:t});function X(t,i){if(t&1&&(n(0,"span",13),s(1),a()),t&2){let e=i.$implicit,m=l(2);C("ngStyle",M(2,Q,m.isReservedDate(e)?"line-through":"inherit")),r(),h(" ",e.day," ")}}function Y(t,i){t&1&&(d(0,"br"),n(1,"span"),s(2,"1-Enero al 31-Marzo"),a(),d(3,"br"),n(4,"span"),s(5,"1-Noviembre al 31-Diciembre"),a(),d(6,"br"))}function Z(t,i){t&1&&(d(0,"br"),n(1,"span"),s(2,"1-Abril al 31-Octubre"),a(),d(3,"br"))}function ee(t,i){if(t&1&&(d(0,"br"),n(1,"li"),s(2),a(),u(3,Y,7,0)(4,Z,4,0)),t&2){let e=i.$implicit;r(2),b("",e.descripcion," = ",e.price,"\u20AC / Noche"),r(),v(e.descripcion=="Temporada Baja"?3:-1),r(),v(e.descripcion=="Temporada Alta"?4:-1)}}function te(t,i){if(t&1&&(n(0,"b",11),s(1),x(2,"date"),x(3,"date"),a()),t&2){let e=l(2);r(),b("",N(2,2,e.reserva.dates[0])," - ",N(3,4,e.reserva.dates[1]),"")}}function ie(t,i){if(t&1&&(n(0,"b",11),s(1),x(2,"currency"),a()),t&2){let e=l(2);r(),h("Total:",E(2,1,e.reserva.priceTotal,"EUR"),"")}}function ne(t,i){if(t&1){let e=R();n(0,"div",1)(1,"div",2)(2,"p-calendar",3),g("ngModelChange",function(){c(e);let o=l();return p(o.priceTotal())}),T("ngModelChange",function(o){c(e);let _=l();return S(_.reserva.dates,o)||(_.reserva.dates=o),p(o)}),u(3,X,2,4,"ng-template",4),a(),n(4,"h4"),s(5,"Tarifas:"),a(),n(6,"ul"),u(7,ee,5,4,"ng-template",5),a()(),n(8,"div",2)(9,"div",6)(10,"label",7),s(11,"Numero de huespedes"),a(),n(12,"p-inputNumber",8),T("ngModelChange",function(o){c(e);let _=l();return S(_.reserva.numHuespedes,o)||(_.reserva.numHuespedes=o),p(o)}),g("ngModelChange",function(){c(e);let o=l();return p(o.priceTotal())}),a(),n(13,"small",9),s(14,"El numero m\xE1ximo de huespedes es 6"),a()(),d(15,"div"),n(16,"div",10),u(17,te,4,6,"b",11)(18,ie,3,4,"b",11),n(19,"p-button",12),g("click",function(){c(e);let o=l();return p(o.reservar())}),a()()()()}if(t&2){let e=l();r(2),y("ngModel",e.reserva.dates),C("inline",!0)("minDate",e.minDate)("readonlyInput",!0),r(5),C("ngForOf",e.tarifas),r(5),y("ngModel",e.reserva.numHuespedes),r(5),v(e.reserva.dates[0]&&e.reserva.dates[1]?17:-1),r(),v(e.reserva.dates[0]&&e.reserva.dates[1]&&e.reserva.priceTotal?18:-1),r(),C("disabled",!e.reserva.dates[0]||!e.reserva.dates[1]||!e.reserva.numHuespedes)}}var K=class t{tarifas=[];reservasService=f($);tarifasService=f(J);cd=f(V);router=f(P);minDate=new Date;allDates={};isAllData=!1;reserva={dates:[],priceTotal:0,numHuespedes:0};constructor(){this.minDate.setDate(this.minDate.getDate()+1),this.reservasService.getAllReservas().subscribe({next:i=>{this.allDates=i,this.isAllData=!0,this.cd.detectChanges()},error:()=>{},complete:()=>{}}),this.tarifasService.getAllTarifas().subscribe(i=>{this.tarifas=i,this.cd.detectChanges()})}isReservedDate(i){return!!this.allDates[`${i.year}-${i.month+1}-${i.day}`]}reservar(){this.reservasService.createReserva(this.reserva).subscribe({next:i=>{this.router.navigate(["/home/reservas"])},error:()=>{},complete:()=>{}})}priceTotal(){this.reservasService.getPrice(this.reserva.numHuespedes,this.reserva.dates).subscribe({next:i=>{this.reserva.priceTotal=i,this.cd.detectChanges()},error:()=>{},complete:()=>{}})}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=D({type:t,selectors:[["app-nueva-reserva"]],standalone:!0,features:[w],decls:4,vars:1,consts:[[1,"flex","justify-content-start"],[1,"card","grid"],[1,"col-12","md:col-6"],["selectionMode","range",3,"ngModelChange","ngModel","inline","minDate","readonlyInput"],["pTemplate","date"],["ngFor","",3,"ngForOf"],[1,"flex","flex-column"],["for",""],["styleClass","w-full","showButtons","true","min","1","max","6",3,"ngModelChange","ngModel"],[1,"text-yellow-200"],[1,"flex","flex-column","justify-content-center","mt-4","w-full"],[1,"flex","justify-content-center"],["styleClass","w-full mt-4 mr-3","label","Reservar",3,"click","disabled"],[3,"ngStyle"]],template:function(e,m){e&1&&(n(0,"div",0)(1,"h2"),s(2,"Nueva Reserva"),a()(),u(3,ne,20,9,"div",1)),e&2&&(r(3),v(m.isAllData?3:-1))},dependencies:[H,I,A,F,B,U,z,L,W,k,j,O,G,q],changeDetection:0})};export{K as NuevaReservaComponent};
